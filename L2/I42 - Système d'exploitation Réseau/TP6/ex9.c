#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <sys/wait.h>
#include <time.h>
#include <stdlib.h>


int main(int argc, char* argv[]){
  int* v1; int* v2;
  int p[2]; int sum=0; int y;
  srand(time(NULL));
  int n =atoi(argv[1]);
  pipe(p);
  v1 = (int*)malloc(sizeof(int)*n);
  v2 = (int*)malloc(sizeof(int)*n);
  int pids[n];

  for(int i = 0; i<=n;i++){
    v1[i] = rand()%10;
    v2[i] = rand()%10;
  }
  for(int j=0; j<n; j++){
    pids[j]=fork();
    if(pids[j] == 0){
      wait(NULL);
      close(p[0]);
      int c = v1[j]*v2[j];
      printf("Processus %d a calcule %d x %d \n",pids[n], v1[j], v2[j]);
      write(p[1], &c, sizeof(c));
      close(p[1]);
    }
  }
}
